import{buildModuleUrl,Check,Color,defined,destroyObject,getElement}from"@cesium/engine";import knockout from"../ThirdParty/knockout.js";import subscribeAndEvaluate from"../subscribeAndEvaluate.js";import InfoBoxViewModel from"./InfoBoxViewModel.js";function InfoBox(e){Check.defined("container",e),e=getElement(e);const t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);const o=document.createElement("div");o.className="cesium-infoBox-title",o.setAttribute("data-bind","text: titleText"),t.appendChild(o);const n=document.createElement("button");n.type="button",n.className="cesium-button cesium-infoBox-camera",n.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),t.appendChild(n);const i=document.createElement("button");i.type="button",i.className="cesium-infoBox-close",i.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),i.innerHTML="&times;",t.appendChild(i);const s=document.createElement("iframe");s.className="cesium-infoBox-iframe",s.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),s.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),s.setAttribute("allowfullscreen",!0),t.appendChild(s);const c=new InfoBoxViewModel;knockout.applyBindings(c,t),this._container=e,this._element=t,this._frame=s,this._viewModel=c,this._descriptionSubscription=void 0;const r=this;s.addEventListener("load",(function(){const e=s.contentDocument,o=e.createElement("link");o.href=buildModuleUrl("Widgets/InfoBox/InfoBoxDescription.css"),o.rel="stylesheet",o.type="text/css";const n=e.createElement("div");n.className="cesium-infoBox-description",e.head.appendChild(o),e.body.appendChild(n),r._descriptionSubscription=subscribeAndEvaluate(c,"description",(function(e){s.style.height="5px",n.innerHTML=e;let o=null;const i=n.firstElementChild;if(null!==i&&1===n.childNodes.length){const e=window.getComputedStyle(i);if(null!==e){const t=e["background-color"],n=Color.fromCssColorString(t);defined(n)&&0!==n.alpha&&(o=e["background-color"])}}t.style["background-color"]=o;const c=n.getBoundingClientRect().height;s.style.height=`${c}px`}))})),s.setAttribute("src","about:blank")}Object.defineProperties(InfoBox.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}}),InfoBox.prototype.isDestroyed=function(){return!1},InfoBox.prototype.destroy=function(){const e=this._container;return knockout.cleanNode(this._element),e.removeChild(this._element),defined(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),destroyObject(this)};export default InfoBox;