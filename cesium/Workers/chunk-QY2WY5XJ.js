/*! For license information please see chunk-QY2WY5XJ.js.LICENSE.txt */
import{EllipsoidTangentPlane_default}from"./chunk-MOLGJDJV.js";import{Plane_default}from"./chunk-4EYB62WJ.js";import{BoundingSphere_default,Intersect_default,Interval_default}from"./chunk-D4YHO4NZ.js";import{Cartesian2_default,Matrix4_default,Rectangle_default}from"./chunk-RSWBNJPT.js";import{Cartesian3_default,Cartographic_default,Ellipsoid_default,Matrix3_default}from"./chunk-PHQVHDVI.js";import{Math_default}from"./chunk-IZED7ODV.js";import{defaultValue_default}from"./chunk-C53JYYKX.js";import{Check_default,DeveloperError_default}from"./chunk-7FEGZO3D.js";import{defined_default}from"./chunk-YS4KPNLC.js";function OrientedBoundingBox(e,a){this.center=Cartesian3_default.clone(defaultValue_default(e,Cartesian3_default.ZERO)),this.halfAxes=Matrix3_default.clone(defaultValue_default(a,Matrix3_default.ZERO))}OrientedBoundingBox.packedLength=Cartesian3_default.packedLength+Matrix3_default.packedLength,OrientedBoundingBox.pack=function(e,a,t){return Check_default.typeOf.object("value",e),Check_default.defined("array",a),t=defaultValue_default(t,0),Cartesian3_default.pack(e.center,a,t),Matrix3_default.pack(e.halfAxes,a,t+Cartesian3_default.packedLength),a},OrientedBoundingBox.unpack=function(e,a,t){return Check_default.defined("array",e),a=defaultValue_default(a,0),defined_default(t)||(t=new OrientedBoundingBox),Cartesian3_default.unpack(e,a,t.center),Matrix3_default.unpack(e,a+Cartesian3_default.packedLength,t.halfAxes),t};var scratchCartesian1=new Cartesian3_default,scratchCartesian2=new Cartesian3_default,scratchCartesian3=new Cartesian3_default,scratchCartesian4=new Cartesian3_default,scratchCartesian5=new Cartesian3_default,scratchCartesian6=new Cartesian3_default,scratchCovarianceResult=new Matrix3_default,scratchEigenResult={unitary:new Matrix3_default,diagonal:new Matrix3_default};OrientedBoundingBox.fromPoints=function(e,a){if(defined_default(a)||(a=new OrientedBoundingBox),!defined_default(e)||0===e.length)return a.halfAxes=Matrix3_default.ZERO,a.center=Cartesian3_default.ZERO,a;let t;const r=e.length,n=Cartesian3_default.clone(e[0],scratchCartesian1);for(t=1;t<r;t++)Cartesian3_default.add(n,e[t],n);const i=1/r;Cartesian3_default.multiplyByScalar(n,i,n);let d,u=0,l=0,s=0,c=0,f=0,o=0;for(t=0;t<r;t++)d=Cartesian3_default.subtract(e[t],n,scratchCartesian2),u+=d.x*d.x,l+=d.x*d.y,s+=d.x*d.z,c+=d.y*d.y,f+=d.y*d.z,o+=d.z*d.z;u*=i,l*=i,s*=i,c*=i,f*=i,o*=i;const _=scratchCovarianceResult;_[0]=u,_[1]=l,_[2]=s,_[3]=l,_[4]=c,_[5]=f,_[6]=s,_[7]=f,_[8]=o;const C=Matrix3_default.computeEigenDecomposition(_,scratchEigenResult),h=Matrix3_default.clone(C.unitary,a.halfAxes);let x=Matrix3_default.getColumn(h,0,scratchCartesian4),m=Matrix3_default.getColumn(h,1,scratchCartesian5),p=Matrix3_default.getColumn(h,2,scratchCartesian6),g=-Number.MAX_VALUE,M=-Number.MAX_VALUE,w=-Number.MAX_VALUE,P=Number.MAX_VALUE,B=Number.MAX_VALUE,O=Number.MAX_VALUE;for(t=0;t<r;t++)d=e[t],g=Math.max(Cartesian3_default.dot(x,d),g),M=Math.max(Cartesian3_default.dot(m,d),M),w=Math.max(Cartesian3_default.dot(p,d),w),P=Math.min(Cartesian3_default.dot(x,d),P),B=Math.min(Cartesian3_default.dot(m,d),B),O=Math.min(Cartesian3_default.dot(p,d),O);x=Cartesian3_default.multiplyByScalar(x,.5*(P+g),x),m=Cartesian3_default.multiplyByScalar(m,.5*(B+M),m),p=Cartesian3_default.multiplyByScalar(p,.5*(O+w),p);const b=Cartesian3_default.add(x,m,a.center);Cartesian3_default.add(b,p,b);const N=scratchCartesian3;return N.x=g-P,N.y=M-B,N.z=w-O,Cartesian3_default.multiplyByScalar(N,.5,N),Matrix3_default.multiplyByScale(a.halfAxes,N,a.halfAxes),a};var scratchOffset=new Cartesian3_default,scratchScale=new Cartesian3_default;function fromPlaneExtents(e,a,t,r,n,i,d,u,l,s,c){if(!(defined_default(n)&&defined_default(i)&&defined_default(d)&&defined_default(u)&&defined_default(l)&&defined_default(s)))throw new DeveloperError_default("all extents (minimum/maximum X/Y/Z) are required.");defined_default(c)||(c=new OrientedBoundingBox);const f=c.halfAxes;Matrix3_default.setColumn(f,0,a,f),Matrix3_default.setColumn(f,1,t,f),Matrix3_default.setColumn(f,2,r,f);let o=scratchOffset;o.x=(n+i)/2,o.y=(d+u)/2,o.z=(l+s)/2;const _=scratchScale;_.x=(i-n)/2,_.y=(u-d)/2,_.z=(s-l)/2;const C=c.center;return o=Matrix3_default.multiplyByVector(f,o,o),Cartesian3_default.add(e,o,C),Matrix3_default.multiplyByScale(f,_,f),c}var scratchRectangleCenterCartographic=new Cartographic_default,scratchRectangleCenter=new Cartesian3_default,scratchPerimeterCartographicNC=new Cartographic_default,scratchPerimeterCartographicNW=new Cartographic_default,scratchPerimeterCartographicCW=new Cartographic_default,scratchPerimeterCartographicSW=new Cartographic_default,scratchPerimeterCartographicSC=new Cartographic_default,scratchPerimeterCartesianNC=new Cartesian3_default,scratchPerimeterCartesianNW=new Cartesian3_default,scratchPerimeterCartesianCW=new Cartesian3_default,scratchPerimeterCartesianSW=new Cartesian3_default,scratchPerimeterCartesianSC=new Cartesian3_default,scratchPerimeterProjectedNC=new Cartesian2_default,scratchPerimeterProjectedNW=new Cartesian2_default,scratchPerimeterProjectedCW=new Cartesian2_default,scratchPerimeterProjectedSW=new Cartesian2_default,scratchPerimeterProjectedSC=new Cartesian2_default,scratchPlaneOrigin=new Cartesian3_default,scratchPlaneNormal=new Cartesian3_default,scratchPlaneXAxis=new Cartesian3_default,scratchHorizonCartesian=new Cartesian3_default,scratchHorizonProjected=new Cartesian2_default,scratchMaxY=new Cartesian3_default,scratchMinY=new Cartesian3_default,scratchZ=new Cartesian3_default,scratchPlane=new Plane_default(Cartesian3_default.UNIT_X,0);OrientedBoundingBox.fromRectangle=function(e,a,t,r,n){if(!defined_default(e))throw new DeveloperError_default("rectangle is required");if(e.width<0||e.width>Math_default.TWO_PI)throw new DeveloperError_default("Rectangle width must be between 0 and 2 * pi");if(e.height<0||e.height>Math_default.PI)throw new DeveloperError_default("Rectangle height must be between 0 and pi");if(defined_default(r)&&!Math_default.equalsEpsilon(r.radii.x,r.radii.y,Math_default.EPSILON15))throw new DeveloperError_default("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");let i,d,u,l,s,c,f;if(a=defaultValue_default(a,0),t=defaultValue_default(t,0),r=defaultValue_default(r,Ellipsoid_default.WGS84),e.width<=Math_default.PI){const o=Rectangle_default.center(e,scratchRectangleCenterCartographic),_=r.cartographicToCartesian(o,scratchRectangleCenter),C=new EllipsoidTangentPlane_default(_,r);f=C.plane;const h=o.longitude,x=e.south<0&&e.north>0?0:o.latitude,m=Cartographic_default.fromRadians(h,e.north,t,scratchPerimeterCartographicNC),p=Cartographic_default.fromRadians(e.west,e.north,t,scratchPerimeterCartographicNW),g=Cartographic_default.fromRadians(e.west,x,t,scratchPerimeterCartographicCW),M=Cartographic_default.fromRadians(e.west,e.south,t,scratchPerimeterCartographicSW),w=Cartographic_default.fromRadians(h,e.south,t,scratchPerimeterCartographicSC),P=r.cartographicToCartesian(m,scratchPerimeterCartesianNC);let B=r.cartographicToCartesian(p,scratchPerimeterCartesianNW);const O=r.cartographicToCartesian(g,scratchPerimeterCartesianCW);let b=r.cartographicToCartesian(M,scratchPerimeterCartesianSW);const N=r.cartographicToCartesian(w,scratchPerimeterCartesianSC),y=C.projectPointToNearestOnPlane(P,scratchPerimeterProjectedNC),E=C.projectPointToNearestOnPlane(B,scratchPerimeterProjectedNW),A=C.projectPointToNearestOnPlane(O,scratchPerimeterProjectedCW),S=C.projectPointToNearestOnPlane(b,scratchPerimeterProjectedSW),R=C.projectPointToNearestOnPlane(N,scratchPerimeterProjectedSC);return i=Math.min(E.x,A.x,S.x),d=-i,l=Math.max(E.y,y.y),u=Math.min(S.y,R.y),p.height=M.height=a,B=r.cartographicToCartesian(p,scratchPerimeterCartesianNW),b=r.cartographicToCartesian(M,scratchPerimeterCartesianSW),s=Math.min(Plane_default.getPointDistance(f,B),Plane_default.getPointDistance(f,b)),c=t,fromPlaneExtents(C.origin,C.xAxis,C.yAxis,C.zAxis,i,d,u,l,s,c,n)}const o=e.south>0,_=e.north<0,C=o?e.south:_?e.north:0,h=Rectangle_default.center(e,scratchRectangleCenterCartographic).longitude,x=Cartesian3_default.fromRadians(h,C,t,r,scratchPlaneOrigin);x.z=0;const m=Math.abs(x.x)<Math_default.EPSILON10&&Math.abs(x.y)<Math_default.EPSILON10?Cartesian3_default.UNIT_X:Cartesian3_default.normalize(x,scratchPlaneNormal),p=Cartesian3_default.UNIT_Z,g=Cartesian3_default.cross(m,p,scratchPlaneXAxis);f=Plane_default.fromPointNormal(x,m,scratchPlane);const M=Cartesian3_default.fromRadians(h+Math_default.PI_OVER_TWO,C,t,r,scratchHorizonCartesian);d=Cartesian3_default.dot(Plane_default.projectPointOntoPlane(f,M,scratchHorizonProjected),g),i=-d,l=Cartesian3_default.fromRadians(0,e.north,_?a:t,r,scratchMaxY).z,u=Cartesian3_default.fromRadians(0,e.south,o?a:t,r,scratchMinY).z;const w=Cartesian3_default.fromRadians(e.east,C,t,r,scratchZ);return s=Plane_default.getPointDistance(f,w),c=0,fromPlaneExtents(x,g,p,m,i,d,u,l,s,c,n)},OrientedBoundingBox.fromTransformation=function(e,a){return Check_default.typeOf.object("transformation",e),defined_default(a)||(a=new OrientedBoundingBox),a.center=Matrix4_default.getTranslation(e,a.center),a.halfAxes=Matrix4_default.getMatrix3(e,a.halfAxes),a.halfAxes=Matrix3_default.multiplyByScalar(a.halfAxes,.5,a.halfAxes),a},OrientedBoundingBox.clone=function(e,a){if(defined_default(e))return defined_default(a)?(Cartesian3_default.clone(e.center,a.center),Matrix3_default.clone(e.halfAxes,a.halfAxes),a):new OrientedBoundingBox(e.center,e.halfAxes)},OrientedBoundingBox.intersectPlane=function(e,a){if(!defined_default(e))throw new DeveloperError_default("box is required.");if(!defined_default(a))throw new DeveloperError_default("plane is required.");const t=e.center,r=a.normal,n=e.halfAxes,i=r.x,d=r.y,u=r.z,l=Math.abs(i*n[Matrix3_default.COLUMN0ROW0]+d*n[Matrix3_default.COLUMN0ROW1]+u*n[Matrix3_default.COLUMN0ROW2])+Math.abs(i*n[Matrix3_default.COLUMN1ROW0]+d*n[Matrix3_default.COLUMN1ROW1]+u*n[Matrix3_default.COLUMN1ROW2])+Math.abs(i*n[Matrix3_default.COLUMN2ROW0]+d*n[Matrix3_default.COLUMN2ROW1]+u*n[Matrix3_default.COLUMN2ROW2]),s=Cartesian3_default.dot(r,t)+a.distance;return s<=-l?Intersect_default.OUTSIDE:s>=l?Intersect_default.INSIDE:Intersect_default.INTERSECTING};var scratchCartesianU=new Cartesian3_default,scratchCartesianV=new Cartesian3_default,scratchCartesianW=new Cartesian3_default,scratchValidAxis2=new Cartesian3_default,scratchValidAxis3=new Cartesian3_default,scratchPPrime=new Cartesian3_default;OrientedBoundingBox.distanceSquaredTo=function(e,a){if(!defined_default(e))throw new DeveloperError_default("box is required.");if(!defined_default(a))throw new DeveloperError_default("cartesian is required.");const t=Cartesian3_default.subtract(a,e.center,scratchOffset),r=e.halfAxes;let n=Matrix3_default.getColumn(r,0,scratchCartesianU),i=Matrix3_default.getColumn(r,1,scratchCartesianV),d=Matrix3_default.getColumn(r,2,scratchCartesianW);const u=Cartesian3_default.magnitude(n),l=Cartesian3_default.magnitude(i),s=Cartesian3_default.magnitude(d);let c=!0,f=!0,o=!0;u>0?Cartesian3_default.divideByScalar(n,u,n):c=!1,l>0?Cartesian3_default.divideByScalar(i,l,i):f=!1,s>0?Cartesian3_default.divideByScalar(d,s,d):o=!1;const _=!c+!f+!o;let C,h,x;if(1===_){let e=n;C=i,h=d,f?o||(e=d,h=n):(e=i,C=n),x=Cartesian3_default.cross(C,h,scratchValidAxis3),e===n?n=x:e===i?i=x:e===d&&(d=x)}else if(2===_){C=n,f?C=i:o&&(C=d);let e=Cartesian3_default.UNIT_Y;e.equalsEpsilon(C,Math_default.EPSILON3)&&(e=Cartesian3_default.UNIT_X),h=Cartesian3_default.cross(C,e,scratchValidAxis2),Cartesian3_default.normalize(h,h),x=Cartesian3_default.cross(C,h,scratchValidAxis3),Cartesian3_default.normalize(x,x),C===n?(i=h,d=x):C===i?(d=h,n=x):C===d&&(n=h,i=x)}else 3===_&&(n=Cartesian3_default.UNIT_X,i=Cartesian3_default.UNIT_Y,d=Cartesian3_default.UNIT_Z);const m=scratchPPrime;m.x=Cartesian3_default.dot(t,n),m.y=Cartesian3_default.dot(t,i),m.z=Cartesian3_default.dot(t,d);let p,g=0;return m.x<-u?(p=m.x+u,g+=p*p):m.x>u&&(p=m.x-u,g+=p*p),m.y<-l?(p=m.y+l,g+=p*p):m.y>l&&(p=m.y-l,g+=p*p),m.z<-s?(p=m.z+s,g+=p*p):m.z>s&&(p=m.z-s,g+=p*p),g};var scratchCorner=new Cartesian3_default,scratchToCenter=new Cartesian3_default;OrientedBoundingBox.computePlaneDistances=function(e,a,t,r){if(!defined_default(e))throw new DeveloperError_default("box is required.");if(!defined_default(a))throw new DeveloperError_default("position is required.");if(!defined_default(t))throw new DeveloperError_default("direction is required.");defined_default(r)||(r=new Interval_default);let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const d=e.center,u=e.halfAxes,l=Matrix3_default.getColumn(u,0,scratchCartesianU),s=Matrix3_default.getColumn(u,1,scratchCartesianV),c=Matrix3_default.getColumn(u,2,scratchCartesianW),f=Cartesian3_default.add(l,s,scratchCorner);Cartesian3_default.add(f,c,f),Cartesian3_default.add(f,d,f);const o=Cartesian3_default.subtract(f,a,scratchToCenter);let _=Cartesian3_default.dot(t,o);return n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.add(d,l,f),Cartesian3_default.add(f,s,f),Cartesian3_default.subtract(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.add(d,l,f),Cartesian3_default.subtract(f,s,f),Cartesian3_default.add(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.add(d,l,f),Cartesian3_default.subtract(f,s,f),Cartesian3_default.subtract(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.subtract(d,l,f),Cartesian3_default.add(f,s,f),Cartesian3_default.add(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.subtract(d,l,f),Cartesian3_default.add(f,s,f),Cartesian3_default.subtract(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.subtract(d,l,f),Cartesian3_default.subtract(f,s,f),Cartesian3_default.add(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),Cartesian3_default.subtract(d,l,f),Cartesian3_default.subtract(f,s,f),Cartesian3_default.subtract(f,c,f),Cartesian3_default.subtract(f,a,o),_=Cartesian3_default.dot(t,o),n=Math.min(_,n),i=Math.max(_,i),r.start=n,r.stop=i,r};var scratchXAxis=new Cartesian3_default,scratchYAxis=new Cartesian3_default,scratchZAxis=new Cartesian3_default;OrientedBoundingBox.computeCorners=function(e,a){Check_default.typeOf.object("box",e),defined_default(a)||(a=[new Cartesian3_default,new Cartesian3_default,new Cartesian3_default,new Cartesian3_default,new Cartesian3_default,new Cartesian3_default,new Cartesian3_default,new Cartesian3_default]);const t=e.center,r=e.halfAxes,n=Matrix3_default.getColumn(r,0,scratchXAxis),i=Matrix3_default.getColumn(r,1,scratchYAxis),d=Matrix3_default.getColumn(r,2,scratchZAxis);return Cartesian3_default.clone(t,a[0]),Cartesian3_default.subtract(a[0],n,a[0]),Cartesian3_default.subtract(a[0],i,a[0]),Cartesian3_default.subtract(a[0],d,a[0]),Cartesian3_default.clone(t,a[1]),Cartesian3_default.subtract(a[1],n,a[1]),Cartesian3_default.subtract(a[1],i,a[1]),Cartesian3_default.add(a[1],d,a[1]),Cartesian3_default.clone(t,a[2]),Cartesian3_default.subtract(a[2],n,a[2]),Cartesian3_default.add(a[2],i,a[2]),Cartesian3_default.subtract(a[2],d,a[2]),Cartesian3_default.clone(t,a[3]),Cartesian3_default.subtract(a[3],n,a[3]),Cartesian3_default.add(a[3],i,a[3]),Cartesian3_default.add(a[3],d,a[3]),Cartesian3_default.clone(t,a[4]),Cartesian3_default.add(a[4],n,a[4]),Cartesian3_default.subtract(a[4],i,a[4]),Cartesian3_default.subtract(a[4],d,a[4]),Cartesian3_default.clone(t,a[5]),Cartesian3_default.add(a[5],n,a[5]),Cartesian3_default.subtract(a[5],i,a[5]),Cartesian3_default.add(a[5],d,a[5]),Cartesian3_default.clone(t,a[6]),Cartesian3_default.add(a[6],n,a[6]),Cartesian3_default.add(a[6],i,a[6]),Cartesian3_default.subtract(a[6],d,a[6]),Cartesian3_default.clone(t,a[7]),Cartesian3_default.add(a[7],n,a[7]),Cartesian3_default.add(a[7],i,a[7]),Cartesian3_default.add(a[7],d,a[7]),a};var scratchRotationScale=new Matrix3_default;OrientedBoundingBox.computeTransformation=function(e,a){Check_default.typeOf.object("box",e),defined_default(a)||(a=new Matrix4_default);const t=e.center,r=Matrix3_default.multiplyByUniformScale(e.halfAxes,2,scratchRotationScale);return Matrix4_default.fromRotationTranslation(r,t,a)};var scratchBoundingSphere=new BoundingSphere_default;OrientedBoundingBox.isOccluded=function(e,a){if(!defined_default(e))throw new DeveloperError_default("box is required.");if(!defined_default(a))throw new DeveloperError_default("occluder is required.");const t=BoundingSphere_default.fromOrientedBoundingBox(e,scratchBoundingSphere);return!a.isBoundingSphereVisible(t)},OrientedBoundingBox.prototype.intersectPlane=function(e){return OrientedBoundingBox.intersectPlane(this,e)},OrientedBoundingBox.prototype.distanceSquaredTo=function(e){return OrientedBoundingBox.distanceSquaredTo(this,e)},OrientedBoundingBox.prototype.computePlaneDistances=function(e,a,t){return OrientedBoundingBox.computePlaneDistances(this,e,a,t)},OrientedBoundingBox.prototype.computeCorners=function(e){return OrientedBoundingBox.computeCorners(this,e)},OrientedBoundingBox.prototype.computeTransformation=function(e){return OrientedBoundingBox.computeTransformation(this,e)},OrientedBoundingBox.prototype.isOccluded=function(e){return OrientedBoundingBox.isOccluded(this,e)},OrientedBoundingBox.equals=function(e,a){return e===a||defined_default(e)&&defined_default(a)&&Cartesian3_default.equals(e.center,a.center)&&Matrix3_default.equals(e.halfAxes,a.halfAxes)},OrientedBoundingBox.prototype.clone=function(e){return OrientedBoundingBox.clone(this,e)},OrientedBoundingBox.prototype.equals=function(e){return OrientedBoundingBox.equals(this,e)};var OrientedBoundingBox_default=OrientedBoundingBox;export{OrientedBoundingBox_default};